package fr.urssaf.image.sae.admin.dfce.exploit.utils;

import java.net.MalformedURLException;
import java.net.URL;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.Locale;

import org.apache.commons.lang.StringUtils;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import fr.urssaf.image.sae.admin.dfce.exploit.model.ConnectionParameter;
import fr.urssaf.image.sae.admin.dfce.exploit.services.impl.ArchiveLogDocumentDFCEServiceImpl;


/**
 * Contient des services de gestion de bean
 * 
 * @author rhofir
 * 
 */
public final class BaseUtils {
   private static final Logger LOGGER = LoggerFactory
   .getLogger(BaseUtils.class);
	private static final String DATE_PATTERN = "yyyy-MM-dd";
   private static final Locale DEFAULT_LOCAL = Locale.FRENCH;;;
   /**
	 * Cette classe ne doit pas avoir de constructeur
	 */
	private BaseUtils() {
		assert false;
	}

	/**
	 * @param cnxParameter
	 *            : Les paramètres de connexion.
	 * @return L'url de connection
	 * @throws MalformedURLException
	 *             : L'exception lorsque la construction de l'url ne s'est pas
	 *             bien construite
	 */
	@SuppressWarnings("PMD.DataflowAnomalyAnalysis")
	public static String buildUrlForConnection(
			final ConnectionParameter cnxParameter)
			throws MalformedURLException {

		URL urlConnection = new URL("http", cnxParameter.getHost()
				.getHostName(), cnxParameter.getHost().getHostPort(),
				cnxParameter.getHost().getContextRoot());
		if (cnxParameter.getHost().isSecure()) {
			urlConnection = new URL("https", cnxParameter.getHost()
					.getHostName(), cnxParameter.getHost().getHostPort(),
					cnxParameter.getHost().getContextRoot());
		}
		return urlConnection.toString();
	}
	/**
    * Convertit une date en chaîne
    * 
    * @param date
    *           : La date à convertir
    * @return chaîne à partir d'une date
    * @throws ParseException
    *            Exception lorsque le parsing de la chaîne ne se déroule pas
    *            bien.
    */
   @SuppressWarnings("PMD.DataflowAnomalyAnalysis")
   public static String dateToString(final Date date){
      String newDate = StringUtils.EMPTY;
      try{
      if (date != null) {
         final SimpleDateFormat formatter = new SimpleDateFormat(
               DATE_PATTERN, DEFAULT_LOCAL);
         newDate = formatter.format(date);
      }
      }catch (Exception e) {
         LOGGER.error("Erreur de parsing. Détail : {}",e.getMessage());
      }
      return newDate;
   }
}
