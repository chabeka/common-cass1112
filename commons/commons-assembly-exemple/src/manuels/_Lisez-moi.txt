// --------------------------------------------------------------------
// Fichiers de configuration
// --------------------------------------------------------------------

Il faut substituer les "variables" HAWAI suivantes par leurs valeurs correspondantes : 

@@SAE_HOME@@
Chemin complet du répertoire "racine" de l'application SAE, dans lequel sont mis
les fichiers de configuration
Exemples :
   /hawai/data/sae
   c:/hawai/data/sae
   

@@DFCE_BASE_NAME@@
Le nom de la base DFCE.
Exemples :
  SAE-TEST
  SAE-GIVN


@@LOGS_PATH@@
Le chemin complet du répertoire dans lequel mettre les fichiers de logs du SAE.
Exemples :
  /hawai/logs/sae
  C:/hawai/logs/sae


@@SAE_CM_JAVA_OPTS@@
Les paramètres supplémentaires à fournir à la JVM dans laquelle s'exécute une capture de masse.
L'objectif est d'y mettre le paramétrage mémoire.
Par exemple, on peut mettre "-Xms500m -Xmx2500m" pour indiquer que la JVM démarre avec 500 Mo de RAM,
et peut monter jusqu'à 2.5 Go de RAM.



De plus, le fichier sae-igc-config.xml est regénéré au niveau d'Hawai.
Pour l'instant, le SAE reconnaît uniquement la PKI de validation n°1 de l'AED.
Du coup, le point de distribution des CRL de cette PKI est :
   <URLTelechargementCRL>
      <url>http://cer69idxpkival1.cer69.recouv/*.crl</url>
   </URLTelechargementCRL>





// --------------------------------------------------------------------
// Répertoires d'installation
// --------------------------------------------------------------------

Les fichiers suivants sont installés dans @@SAE_HOME@@/
  sae-config.properties
  sae-dfce-config.properties
  ecdesources.xml
  sae-igc-config.xml


Les répertoires suivants doivent être créés :
  @@SAE_HOME@@/certificats
  @@SAE_HOME@@/certificats/ACRacineDeConfiance/
  @@SAE_HOME@@/certificats/CRL/
  @@SAE_HOME@@/sae-igcmaj/
  @@SAE_HOME@@/sae-services-executable/
  @@SAE_HOME@@/sae-dfce-admin-exploit/
  @@SAE_HOME@@/sae-ordonnanceur/
  @@SAE_HOME@@/sae-lotinstallmaj/
  


Les fichiers ci-dessous sont installés dans @@SAE_HOME@@/certificats/ACRacineDeConfiance/
  pseudo_IGCA.crt


Les fichiers ci-dessous sont installés dans @@SAE_HOME@@/sae-igcmaj/
  sae-igcmaj-exe.jar
  

Les fichiers ci-dessous sont installés dans @@SAE_HOME@@/sae-services-executable/
  sae-services-executable.jar
  logback-sae-services-executable.xml


Les fichiers ci-dessous sont installés dans @@SAE_HOME@@/sae-dfce-admin-exploit/
  sae-dfce-admin-exploit.jar
  logback-sae-dfce-admin-exploit.xml
  saeBase.xml
  LifeCycleRule.xml


Les fichiers ci-dessous sont installés dans @@SAE_HOME@@/sae-lotinstallmaj/
 sae-lotinstallmaj.jar
 logback-sae-lotinstallmaj.xml
 

Les fichiers ci-dessous sont installés dans @@SAE_HOME@@/sae-ordonnanceur/
 sae-ordonnanceur.jar
 logback-sae-ordonnanceur.xml
 sae-ordonnanceur.sh



// --------------------------------------------------------------------
// Commande de lancement de sae-igcmaj-exe.jar
// --------------------------------------------------------------------

java -jar @@SAE_HOME@@/sae-igcmaj/sae-igcmaj-exe.jar @@SAE_HOME@@/sae-igc-config.xml




// --------------------------------------------------------------------
// Commande de lancement de sae-services-executable.jar
// --------------------------------------------------------------------

Ce programme est lancé par l'ordonnanceur (sae-ordonnanceur.jar).

Le début de la ligne de commande pour l'appel à sae-services-executable.jar est
lu depuis le fichier de configuration général sae-config.properties, dans la clé
sae.archivagemasse.executable

L'ordonnanceur complète la ligne de commande avec les actions suivantes :
- remplace le marqueur _XMS_TO_REPLACE_ par la valeur par défaut 500m
- remplace le marqueur _XMX_TO_REPLACE_ par la valeur par défaut 500m
- remplace le marqueur _UUID_TO_REPLACE par l'identifiant unique du traitement de masse
- ajoute à la fin de la ligne de commande :
   traitementMasse [IdentifiantDuTraitementDeMasse] [CheminFichierConfigurationSAE]
  avec :
    [IdentifiantDuTraitementDeMasse] l'identifiant unique du traitement de masse
    [CheminFichierConfigurationSAE] le chemin complet du fichier de configuration général



// --------------------------------------------------------------------
// Commandes de lancement de sae-dfce-admin-exploit.jar
// --------------------------------------------------------------------

// Pour lancer la création de la base DFCE
java -jar -Dlogback.configurationFile=@@SAE_HOME@@/sae-dfce-admin-exploit/logback-sae-dfce-admin-exploit.xml @@SAE_HOME@@/sae-dfce-admin-exploit/sae-dfce-admin-exploit.jar createDataBase @@SAE_HOME@@/sae-config.properties @@SAE_HOME@@/sae-dfce-admin-exploit/saeBase.xml @@SAE_HOME@@/sae-dfce-admin-exploit/LifeCycleRule.xml

// Pour lancer la réindexation de la base DFCE
java -jar -Dlogback.configurationFile=@@SAE_HOME@@/sae-dfce-admin-exploit/logback-sae-dfce-admin-exploit.xml @@SAE_HOME@@/sae-dfce-admin-exploit/sae-dfce-admin-exploit.jar reindex @@SAE_HOME@@/sae-config.properties

// Pour lancer la création des journaux des événements
java -jar -Dlogback.configurationFile=@@SAE_HOME@@/sae-dfce-admin-exploit/logback-sae-dfce-admin-exploit.xml @@SAE_HOME@@/sae-dfce-admin-exploit/sae-dfce-admin-exploit.jar creatSystemEvent @@SAE_HOME@@/sae-config.properties

// Pour consulter le dernier journal des événements créé
java -jar -Dlogback.configurationFile=@@SAE_HOME@@/sae-dfce-admin-exploit/logback-sae-dfce-admin-exploit.xml @@SAE_HOME@@/sae-dfce-admin-exploit/sae-dfce-admin-exploit.jar consultSystemEvent @@SAE_HOME@@/sae-config.properties /tmp

// Pour lancer la purge des traces des événements
java -jar -Dlogback.configurationFile=@@SAE_HOME@@/sae-dfce-admin-exploit/logback-sae-dfce-admin-exploit.xml @@SAE_HOME@@/sae-dfce-admin-exploit/sae-dfce-admin-exploit.jar clearSystemEvent @@SAE_HOME@@/sae-config.properties 30

// Pour lancer la création des journaux du cycle de vie des archives
java -jar -Dlogback.configurationFile=@@SAE_HOME@@/sae-dfce-admin-exploit/logback-sae-dfce-admin-exploit.xml @@SAE_HOME@@/sae-dfce-admin-exploit/sae-dfce-admin-exploit.jar createDocEvent @@SAE_HOME@@/sae-config.properties

// Pour consulter le dernier journal du cycle de vie des archives créé
java -jar -Dlogback.configurationFile=@@SAE_HOME@@/sae-dfce-admin-exploit/logback-sae-dfce-admin-exploit.xml @@SAE_HOME@@/sae-dfce-admin-exploit/sae-dfce-admin-exploit.jar consultDocEvent @@SAE_HOME@@/sae-config.properties /tmp

// Pour lancer la purge des traces du cycle de vie des archives
java -jar -Dlogback.configurationFile=@@SAE_HOME@@/sae-dfce-admin-exploit/logback-sae-dfce-admin-exploit.xml @@SAE_HOME@@/sae-dfce-admin-exploit/sae-dfce-admin-exploit.jar clearDocEvent @@SAE_HOME@@/sae-config.properties 30

// Pour lancer la mise à jour des durée de conservation des documents
java -jar -Dlogback.configurationFile=@@SAE_HOME@@/sae-dfce-admin-exploit/logback-sae-dfce-admin-exploit.xml @@SAE_HOME@@/sae-dfce-admin-exploit/sae-dfce-admin-exploit.jar updateLifecycleRules @@SAE_HOME@@/sae-config.properties @@SAE_HOME@@/sae-dfce-admin-exploit/LifeCycleRule.xml



// --------------------------------------------------------------------
// Commandes de lancement de sae-lotinstallmaj
// --------------------------------------------------------------------

// Installation du lot SAE-120510 - Pour rendre le code activité non obligatoire
java -Dlogback.configurationFile=@@SAE_HOME@@/sae-lotinstallmaj/logback-sae-lotinstallmaj.xml -jar @@SAE_HOME@@/sae-lotinstallmaj/sae-lotinstallmaj.jar @@SAE_HOME@@/sae-config.properties CODEACTIVITENONOBLIGATOIRE 

// Installation du lot SAE-120511 - Création de la base Cassandra "SAE"
// La base "SAE" contient la pile des travaux et la persistance d'état des travaux Spring Batch   
java -Dlogback.configurationFile=@@SAE_HOME@@/sae-lotinstallmaj/logback-sae-lotinstallmaj.xml -jar @@SAE_HOME@@/sae-lotinstallmaj/sae-lotinstallmaj.jar @@SAE_HOME@@/sae-config.properties CASSANDRA_120510

// Installation du lot SAE-120512 - Mise à niveau de la base Cassandra "SAE" 
java -Dlogback.configurationFile=@@SAE_HOME@@/sae-lotinstallmaj/logback-sae-lotinstallmaj.xml -jar @@SAE_HOME@@/sae-lotinstallmaj/sae-lotinstallmaj.jar @@SAE_HOME@@/sae-config.properties CASSANDRA_120512

// Installation du lot SAE-120513 - Mise à niveau de la base Cassandra "SAE" 
java -Dlogback.configurationFile=@@SAE_HOME@@/sae-lotinstallmaj/logback-sae-lotinstallmaj.xml -jar @@SAE_HOME@@/sae-lotinstallmaj/sae-lotinstallmaj.jar @@SAE_HOME@@/sae-config.properties CASSANDRA_120513


// --------------------------------------------------------------------
// Commandes de lancement de sae-ordonnanceur
// --------------------------------------------------------------------

// Attention : l'ordonnanceur ne rend pas la main, et est censé être en permanance en cours d'exécution
java -Dlogback.configurationFile=@@SAE_HOME@@/sae-ordonnanceur/logback-sae-ordonnanceur.xml -jar @@SAE_HOME@@/sae-ordonnanceur/sae-ordonnanceur.jar @@SAE_HOME@@/sae-config.properties 




// --------------------------------------------------------------------
// Les CRON à créer
// --------------------------------------------------------------------

- un cron qui une fois par jour lance sae-igcmaj-exe.jar

- un cron qui une fois par jour lance, dans l'ordre :
    - sae-dfce-admin-exploit.jar reindex
    - sae-dfce-admin-exploit.jar creatSystemEvent
    - sae-dfce-admin-exploit.jar clearSystemEvent
    - sae-dfce-admin-exploit.jar creatDocEvent
    - sae-dfce-admin-exploit.jar clearDocEvent


