<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib uri="http://displaytag.sf.net" prefix="display"%>
<%@taglib prefix="custom" uri="/WEB-INF/tld/map.tld"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>IHM Web Exploit - Consultation des Dictionnaires</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link href="css/displaytag.css" rel="stylesheet" type="text/css" />
<link href="css/formulaire.css" rel="stylesheet" type="text/css" />
<link href="css/calendrier.css" rel="stylesheet" media="screen"
	type="text/css" title="Design" />

<script type="text/javascript" src="js/calendrier.js"></script>
<script type="text/javascript">


   function intiForm() {
      var ajout = document.getElementById("ajout").value;
      if (ajout == 'true') {
         var id = document.getElementById('id');
         id.removeAttribute("readonly");
         activateModifiableMeta();
      }
   }

   function activateModifiableMeta() {
      var valeurs = document.getElementById('valeurs');
      valeurs.removeAttribute("readonly");
      var message = document.getElementById('message');
      message.innerHTML='';
      if(document.getElementById('modification').value =='true'){
      	document.getElementById('bouttonModifier').style.display = "block";
      }
   }

   function checkModifiedData() {

      if (document.getElementById('id').value == null
            || document.getElementById('id').value == '') {
         document.getElementById("erreur").innerHTML = "L'identifiant du dictionnaire est obligatoire";
         return false;
      }
      ;
      if (document.getElementById('valeurs').value == null
            || document.getElementById('valeurs').value == '') {
         document.getElementById("erreur").innerHTML = "Il est nécessaire de préciser au moins une valeur";
         return false;
      }
      ;

   
      return true;
   }


   function submitForm(action) {

      if (action == 'modifier') {
         document.forms[0].action = 'gestionDictionnaire.do?action=modifier';
         if (checkModifiedData()) {
            document.forms[0].submit();
         } else {
            return false;
         }
      } else if (action == 'ajouter') {
         document.forms[0].action = 'gestionDictionnaire.do?action=ajouter';
         if (checkModifiedData()) {
            document.forms[0].submit();
         } else {
            return false;
         }
      }

   }
</script>



</head>

<body onload="intiForm()">

<form:form method="post" modelAttribute="dictForm">
	<form:hidden id="ajout" path="ajout" />
	<form:hidden id="modification" path="modification" />

	<h6 class="msg_erreur" id="erreur"><form:errors path='*' /></h6>
	<h5><form:label id="message" path="message"><c:out value="${dictForm.message}"></c:out></form:label></h5>
	<table>
		<tr>
			<td>Identifiant</td>
			<td><form:input id="id" path="detailDico.identifiant"
				size="40" readonly="true" /></td>
		</tr>
		<tr>
			<td>Valeurs<br />(les séparer par des virgules)</td>
			<td><form:textarea id="valeurs"  path="detailDico.entries"
				readonly="true"  cssStyle="wrap='virtual'" cols="60" rows="20" /></td>
		</tr>
		
		<tr>
			<c:if test="${dictForm.ajout =='false'}">
				<td><a href="#" title="Modifier la métadonnées"
					onclick="activateModifiableMeta()">Modifier le dictionnaire</a></td>
			</c:if>
		</tr>
	</table>
	
	<c:if test="${dictForm.modification=='true'}">
		<p style="text-align: right"><input style="display: none"
			id="bouttonModifier" type="submit" onclick="submitForm('modifier')"
			value="Modifier" /></p>
	</c:if>
	<c:if test="${dictForm.ajout =='true'}">
		<p><input type="submit"
			onclick="return submitForm('ajouter');" value="Ajouter" /></p>
	</c:if>

</form:form>

</body>
</html>


